# VBRPG 单人游戏模式 - 需求规格文档

## 1. 项目概述

### 1.1 项目背景
- **项目起源**：当前 VBRPG 平台设计为多人在线桌游平台，需要玩家等待他人加入才能开始游戏，用户体验存在等待时间长、匹配困难等问题
- **核心问题**：用户希望能够随时随地进行桌游体验，无需等待其他真人玩家，同时避免繁琐的注册登录流程
- **项目愿景**：将 VBRPG 改造为纯单人桌游体验平台，所有非用户角色均由 AI 控制，用户可即开即玩

### 1.2 业务价值
- **业务目标**：降低用户使用门槛，提升用户即时游戏体验
- **预期价值**：
  - 消除用户等待时间，随时可玩
  - 简化用户流程，无需注册登录
  - 提供沉浸式单人桌游体验
- **成功指标**：
  - 用户从进入页面到开始游戏的时间 < 30 秒
  - 游戏流程无需任何身份验证步骤

### 1.3 项目范围
- **包含范围**：
  - 后端 API 改造，支持单人游戏模式
  - 移除多人对战相关功能
  - 移除用户登录/注册功能
  - 支持用户选择旁观者或参与者角色
  - 游戏暂停/停止功能
- **排除范围**：
  - 前端界面改造（本次需求仅针对后端）
  - 游戏进度保存功能
  - 多人联机功能
- **交付物**：
  - 后端 API 接口变更
  - 数据模型调整

## 2. 利益相关者分析

### 2.1 用户群体
- **主要用户**：希望体验桌游但无法凑齐玩家的单人用户
- **用户画像**：
  - 对桌游感兴趣但缺少固定玩伴
  - 希望快速上手，无需复杂的账户管理
  - 可能是桌游新手，希望通过 AI 对战学习游戏规则

### 2.2 使用场景
- **主要场景**：用户进入平台，创建房间，选择参与角色或旁观模式，立即开始游戏
- **次要场景**：用户在游戏过程中暂停或停止游戏
- **边界场景**：用户关闭浏览器，游戏直接结束，无需保存

## 3. 功能需求

### 3.1 核心功能领域

#### P0 - 必须实现的核心功能

**功能领域1：匿名用户支持**
- **业务价值**：降低使用门槛，用户无需注册登录即可直接使用平台
- **关键用户故事**：
  作为一个用户，我希望能够直接进入游戏，无需创建账户或登录，这样我可以立即开始游戏体验
- **验收标准**：
  - 后端 API 不再要求身份验证
  - 移除用户注册/登录相关接口
  - 每个游戏会话使用临时标识符进行管理

**功能领域2：单人游戏房间创建**
- **业务价值**：简化房间创建流程，自动填充 AI 玩家
- **关键用户故事**：
  作为一个用户，我希望创建房间后系统自动分配 AI 玩家填充所有非我控制的角色，这样我无需等待其他真人加入
- **验收标准**：
  - 创建房间时根据游戏类型自动确定玩家数量范围
  - 除用户选择的角色外，其余角色全部由 AI 控制
  - 移除房间码分享功能
  - 移除其他玩家加入房间的功能

**功能领域3：角色选择**
- **业务价值**：让用户自主选择游戏参与方式，提供灵活的游戏体验
- **关键用户故事**：
  作为一个用户，我希望在创建房间后能够选择作为旁观者观看 AI 对局，或选择扮演其中一个角色参与游戏
- **验收标准**：
  - 提供旁观者模式选项
  - 提供角色列表供用户选择
  - 角色选择确认后不可更改
  - 旁观者模式下所有角色均由 AI 控制

**功能领域4：游戏即时开始**
- **业务价值**：用户选择完成后可立即开始游戏，无需等待
- **关键用户故事**：
  作为一个用户，我选择好角色后希望能立即开始游戏，不需要等待其他准备步骤
- **验收标准**：
  - 角色选择确认后自动开始游戏
  - AI 玩家自动完成准备流程
  - 游戏状态立即进入进行中

**功能领域5：游戏控制（暂停/停止）**
- **业务价值**：让用户能够控制游戏进程
- **关键用户故事**：
  作为一个用户，我希望能够暂停游戏以便休息，或直接停止游戏退出
- **验收标准**：
  - 旁观者和参与者均可暂停游戏
  - 旁观者和参与者均可停止游戏
  - 暂停后可恢复游戏继续进行
  - 停止游戏后房间直接结束，不保存进度
  - 旁观者模式下不能进行除暂停/停止外的其他游戏操作

#### P1 - 重要功能

**功能领域6：AI 玩家自动管理**
- **业务价值**：确保游戏能够流畅进行，无需用户管理 AI 玩家
- **关键用户故事**：
  作为一个用户，我希望 AI 玩家能够自动进行游戏行为，无需我进行任何管理操作
- **验收标准**：
  - AI 玩家自动响应游戏回合
  - AI 玩家具有合理的决策行为
  - 游戏进程流畅，无需用户干预 AI 行为

### 3.2 功能依赖关系
- **前置依赖**：游戏类型配置（决定玩家数量上下限）
- **实现顺序**：
  1. 移除用户认证功能
  2. 改造房间创建逻辑
  3. 实现角色选择功能
  4. 实现游戏暂停/停止功能
  5. 优化 AI 玩家自动管理

## 4. 非功能性需求

### 4.1 用户体验需求
- **易用性**：API 调用简单直观，无需复杂的前置步骤
- **学习成本**：用户无需理解多人游戏的概念，直接作为单人游戏使用

### 4.2 性能需求
- **响应时间**：API 响应时间 < 500ms
- **并发能力**：支持单用户独立游戏会话

## 5. 风险评估

### 5.1 业务风险
- **高风险项**：移除多人功能后，原有的多人游戏逻辑需要大量改造
- **中等风险项**：AI 玩家行为需要确保游戏体验良好

### 5.2 风险应对策略
- **规避措施**：充分测试单人游戏流程
- **缓解计划**：渐进式移除多人功能，确保核心游戏逻辑不受影响

## 6. 成功标准

### 6.1 业务成功指标
- **核心指标**：用户可以无障碍地完成一局完整的单人游戏
- **预期收益**：提升用户体验，降低使用门槛

### 6.2 项目完成标准
- **功能完整**：
  - 用户可无需登录直接使用
  - 房间创建后自动填充 AI 玩家
  - 用户可选择旁观或参与
  - 游戏可暂停/停止
  - 移除所有多人对战相关功能
- **质量达标**：所有后端 API 测试通过

## 7. 依赖关系

### 7.1 内部依赖
- **技术依赖**：现有 AI 代理系统、游戏引擎
- **流程依赖**：游戏类型配置（玩家数量上下限）

### 7.2 外部依赖
- **第三方服务**：LLM 服务（AI 玩家决策）

## 8. 优先级排序
- **功能优先级**：
  1. P0：匿名用户支持
  2. P0：单人游戏房间创建
  3. P0：角色选择
  4. P0：游戏即时开始
  5. P0：游戏控制（暂停/停止）
  6. P1：AI 玩家自动管理
- **交付顺序**：按优先级顺序依次实现
